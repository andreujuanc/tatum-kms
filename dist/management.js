"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getQuestion = exports.getTatumKey = exports.removeWallet = exports.getAddress = exports.getPrivateKey = exports.getWallet = exports.storePrivateKey = exports.storeWallet = exports.getManagedWallets = exports.exportWallets = void 0;
const tatum_1 = require("@tatumio/tatum");
const tatum_kcs_1 = require("@tatumio/tatum-kcs");
const tatum_solana_1 = require("@tatumio/tatum-solana");
const terra_1 = require("@tatumio/terra");
const crypto_js_1 = require("crypto-js");
const fs_1 = require("fs");
const os_1 = require("os");
const path_1 = require("path");
const readline_sync_1 = require("readline-sync");
const uuid_1 = require("uuid");
const config_1 = require("./config");
const config = new config_1.Config();
const ensurePathExists = (path) => {
    const dir = path_1.dirname(path);
    if (!fs_1.existsSync(dir)) {
        fs_1.mkdirSync(dir, { recursive: true });
    }
};
exports.exportWallets = (path) => {
    const pwd = config.getValue(config_1.ConfigOption.KMS_PASSWORD);
    const pathToWallet = path || os_1.homedir() + '/.tatumrc/wallet.dat';
    if (!fs_1.existsSync(pathToWallet)) {
        console.error(JSON.stringify({ error: `No such wallet file.` }, null, 2));
        return;
    }
    const data = fs_1.readFileSync(pathToWallet, { encoding: 'utf8' });
    if (!data?.length) {
        console.error(JSON.stringify({ error: `No such wallet file.` }, null, 2));
        return;
    }
    console.log(JSON.stringify(JSON.parse(crypto_js_1.AES.decrypt(data, pwd).toString(crypto_js_1.enc.Utf8)), null, 2));
};
exports.getManagedWallets = (pwd, chain, testnet, path) => {
    const pathToWallet = path || os_1.homedir() + '/.tatumrc/wallet.dat';
    if (!fs_1.existsSync(pathToWallet)) {
        console.error(JSON.stringify({ error: `No such wallet file.` }, null, 2));
        return [];
    }
    const data = fs_1.readFileSync(pathToWallet, { encoding: 'utf8' });
    if (!data?.length) {
        return [];
    }
    const wallets = JSON.parse(crypto_js_1.AES.decrypt(data, pwd).toString(crypto_js_1.enc.Utf8));
    const keys = [];
    for (const walletsKey in wallets) {
        if (chain === wallets[walletsKey].chain && testnet === wallets[walletsKey].testnet) {
            keys.push(walletsKey);
        }
    }
    return keys;
};
exports.storeWallet = async (chain, testnet, path, mnemonic) => {
    const pwd = config.getValue(config_1.ConfigOption.KMS_PASSWORD);
    const pathToWallet = path || os_1.homedir() + '/.tatumrc/wallet.dat';
    let wallet;
    if (chain === tatum_1.Currency.SOL) {
        wallet = await tatum_solana_1.generateWallet();
    }
    else if (chain === tatum_1.Currency.KCS) {
        wallet = await tatum_kcs_1.generateWallet(mnemonic, { testnet });
    }
    else if (chain === tatum_1.Currency.LUNA) {
        wallet = terra_1.TatumTerraSDK({ apiKey: process.env.TATUM_API_KEY }).wallet.wallet();
    }
    else {
        wallet = await tatum_1.generateWallet(chain, testnet, mnemonic);
    }
    const key = uuid_1.v4();
    const entry = { [key]: { ...wallet, chain, testnet } };
    if (!fs_1.existsSync(pathToWallet)) {
        ensurePathExists(pathToWallet);
        fs_1.writeFileSync(pathToWallet, crypto_js_1.AES.encrypt(JSON.stringify(entry), pwd).toString());
    }
    else {
        const data = fs_1.readFileSync(pathToWallet, { encoding: 'utf8' });
        let walletData = entry;
        if (data?.length > 0) {
            walletData = { ...walletData, ...JSON.parse(crypto_js_1.AES.decrypt(data, pwd).toString(crypto_js_1.enc.Utf8)) };
        }
        fs_1.writeFileSync(pathToWallet, crypto_js_1.AES.encrypt(JSON.stringify(walletData), pwd).toString());
    }
    const value = { signatureId: key };
    if (wallet.address) {
        value.address = wallet.address;
    }
    if (wallet.xpub) {
        value.xpub = wallet.xpub;
    }
    console.log(JSON.stringify(value, null, 2));
};
exports.storePrivateKey = async (chain, testnet, privateKey, path) => {
    const pwd = config.getValue(config_1.ConfigOption.KMS_PASSWORD);
    const pathToWallet = path || os_1.homedir() + '/.tatumrc/wallet.dat';
    const key = uuid_1.v4();
    const entry = { [key]: { privateKey, chain, testnet } };
    if (!fs_1.existsSync(pathToWallet)) {
        ensurePathExists(pathToWallet);
        fs_1.writeFileSync(pathToWallet, crypto_js_1.AES.encrypt(JSON.stringify(entry), pwd).toString());
    }
    else {
        const data = fs_1.readFileSync(pathToWallet, { encoding: 'utf8' });
        let walletData = entry;
        if (data?.length > 0) {
            walletData = { ...walletData, ...JSON.parse(crypto_js_1.AES.decrypt(data, pwd).toString(crypto_js_1.enc.Utf8)) };
        }
        fs_1.writeFileSync(pathToWallet, crypto_js_1.AES.encrypt(JSON.stringify(walletData), pwd).toString());
    }
    console.log(JSON.stringify({ signatureId: key }, null, 2));
};
exports.getWallet = async (id, path, pwd, print = true) => {
    const password = pwd ?? config.getValue(config_1.ConfigOption.KMS_PASSWORD);
    const pathToWallet = path || os_1.homedir() + '/.tatumrc/wallet.dat';
    if (!fs_1.existsSync(pathToWallet)) {
        console.error(JSON.stringify({ error: `No such wallet for signatureId '${id}'.` }, null, 2));
        return;
    }
    const data = fs_1.readFileSync(pathToWallet, { encoding: 'utf8' });
    if (!data?.length) {
        console.error(JSON.stringify({ error: `No such wallet for signatureId '${id}'.` }, null, 2));
        return;
    }
    try {
        const wallet = JSON.parse(crypto_js_1.AES.decrypt(data, password).toString(crypto_js_1.enc.Utf8));
        if (!wallet[id]) {
            console.error(JSON.stringify({ error: `No such wallet for signatureId '${id}'.` }, null, 2));
            return;
        }
        if (print) {
            console.log(JSON.stringify(wallet[id], null, 2));
        }
        return wallet[id];
    }
    catch (e) {
        console.error(JSON.stringify({ error: `Wrong password.` }, null, 2));
        return;
    }
};
exports.getPrivateKey = async (id, index, path) => {
    const pwd = config.getValue(config_1.ConfigOption.KMS_PASSWORD);
    const pathToWallet = path || os_1.homedir() + '/.tatumrc/wallet.dat';
    if (!fs_1.existsSync(pathToWallet)) {
        console.error(JSON.stringify({ error: `No such wallet for signatureId '${id}'.` }, null, 2));
        return;
    }
    const data = fs_1.readFileSync(pathToWallet, { encoding: 'utf8' });
    if (!data?.length) {
        console.error(JSON.stringify({ error: `No such wallet for signatureId '${id}'.` }, null, 2));
        return;
    }
    const wallet = JSON.parse(crypto_js_1.AES.decrypt(data, pwd).toString(crypto_js_1.enc.Utf8));
    if (!wallet[id]) {
        console.error(JSON.stringify({ error: `No such wallet for signatureId '${id}'.` }, null, 2));
        return;
    }
    const pk = { privateKey: (wallet[id].secret
            ? wallet[id].secret
            : await tatum_1.generatePrivateKeyFromMnemonic(wallet[id].chain, wallet[id].testnet, wallet[id].mnemonic, parseInt(index))) };
    console.log(JSON.stringify(pk, null, 2));
};
exports.getAddress = async (id, index, path) => {
    const pwd = config.getValue(config_1.ConfigOption.KMS_PASSWORD);
    const pathToWallet = path || os_1.homedir() + '/.tatumrc/wallet.dat';
    if (!fs_1.existsSync(pathToWallet)) {
        console.error(JSON.stringify({ error: `No such wallet for signatureId '${id}'.` }, null, 2));
        return;
    }
    const data = fs_1.readFileSync(pathToWallet, { encoding: 'utf8' });
    if (!data?.length) {
        console.error(JSON.stringify({ error: `No such wallet for signatureId '${id}'.` }, null, 2));
        return;
    }
    const wallet = JSON.parse(crypto_js_1.AES.decrypt(data, pwd).toString(crypto_js_1.enc.Utf8));
    if (!wallet[id]) {
        console.error(JSON.stringify({ error: `No such wallet for signatureId '${id}'.` }, null, 2));
        return;
    }
    const pk = { address: (wallet[id].address ? wallet[id].address : await tatum_1.generateAddressFromXPub(wallet[id].chain, wallet[id].testnet, wallet[id].xpub, parseInt(index))) };
    console.log(JSON.stringify(pk, null, 2));
};
exports.removeWallet = async (id, path) => {
    const pwd = config.getValue(config_1.ConfigOption.KMS_PASSWORD);
    const pathToWallet = path || os_1.homedir() + '/.tatumrc/wallet.dat';
    if (!fs_1.existsSync(pathToWallet)) {
        console.error(JSON.stringify({ error: `No such wallet for signatureId '${id}'.` }, null, 2));
        return;
    }
    const data = fs_1.readFileSync(pathToWallet, { encoding: 'utf8' });
    if (!data?.length) {
        console.error(JSON.stringify({ error: `No such wallet for signatureId '${id}'.` }, null, 2));
        return;
    }
    const wallet = JSON.parse(crypto_js_1.AES.decrypt(data, pwd).toString(crypto_js_1.enc.Utf8));
    delete wallet[id];
    fs_1.writeFileSync(pathToWallet, crypto_js_1.AES.encrypt(JSON.stringify(wallet), pwd).toString());
};
exports.getTatumKey = (apiKey) => {
    if (apiKey) {
        process.env.TATUM_API_KEY = apiKey;
        return;
    }
};
exports.getQuestion = (q, e) => {
    if (e) {
        return e;
    }
    return readline_sync_1.question(q, {
        hideEchoBack: true,
    });
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFuYWdlbWVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9tYW5hZ2VtZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLDBDQUFpSDtBQUNqSCxrREFBeUU7QUFDekUsd0RBQTZFO0FBQzdFLDBDQUE0QztBQUM1Qyx5Q0FBbUM7QUFDbkMsMkJBQXNFO0FBQ3RFLDJCQUEyQjtBQUMzQiwrQkFBNkI7QUFDN0IsaURBQXVDO0FBQ3ZDLCtCQUFnQztBQUNoQyxxQ0FBOEM7QUFFOUMsTUFBTSxNQUFNLEdBQUcsSUFBSSxlQUFNLEVBQUUsQ0FBQztBQUM1QixNQUFNLGdCQUFnQixHQUFHLENBQUMsSUFBWSxFQUFFLEVBQUU7SUFDdEMsTUFBTSxHQUFHLEdBQUcsY0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzFCLElBQUksQ0FBQyxlQUFVLENBQUMsR0FBRyxDQUFDLEVBQUU7UUFDbEIsY0FBUyxDQUFDLEdBQUcsRUFBRSxFQUFDLFNBQVMsRUFBRSxJQUFJLEVBQUMsQ0FBQyxDQUFDO0tBQ3JDO0FBQ0wsQ0FBQyxDQUFDO0FBRVcsUUFBQSxhQUFhLEdBQUcsQ0FBQyxJQUFhLEVBQUUsRUFBRTtJQUMzQyxNQUFNLEdBQUcsR0FBRyxNQUFNLENBQUMsUUFBUSxDQUFDLHFCQUFZLENBQUMsWUFBWSxDQUFDLENBQUE7SUFDdEQsTUFBTSxZQUFZLEdBQUcsSUFBSSxJQUFJLFlBQU8sRUFBRSxHQUFHLHNCQUFzQixDQUFDO0lBQ2hFLElBQUksQ0FBQyxlQUFVLENBQUMsWUFBWSxDQUFDLEVBQUU7UUFDM0IsT0FBTyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUMsS0FBSyxFQUFFLHNCQUFzQixFQUFDLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDeEUsT0FBTztLQUNWO0lBQ0QsTUFBTSxJQUFJLEdBQUcsaUJBQVksQ0FBQyxZQUFZLEVBQUUsRUFBQyxRQUFRLEVBQUUsTUFBTSxF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